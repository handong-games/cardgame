# 해상도 & 화면 비율 대응

> Unity 프로젝트의 해상도 및 화면 비율 처리 전략

---

## 핵심 원칙

### 1. UI 기준: 16:9
- **기준 해상도**: 1920×1080 (16:9)
- 모든 UI는 **16:9 SafeArea 내에서만** 배치
- SafeArea 외부에 UI/게임 콘텐츠 배치 금지

### 2. 검은 바는 "시스템"
- Letterbox/Pillarbox는 **장식이 아닌 시스템 영역**
- UI/게임 콘텐츠가 **절대 침범하지 않음**
- 검은 바 영역은 순수하게 빈 공간으로 유지

### 3. SafeArea 16:9 원칙
- `SafeArea16x9`의 **width/height만 사용**
- 모든 배치는 **기준 해상도 좌표계**에서 계산
- 화면 픽셀 좌표가 아닌 논리 좌표 사용

### 4. 스크린샷/녹화/스트리밍 대응
- **16:9 SafeArea만 캡처**
- 검은 바 영역은 캡처에서 제외
- 방송/녹화 시 일관된 16:9 영상 출력

---

## 화면 비율별 대응

| 화면 비율 | 대응 방식 | 설명 |
|----------|----------|------|
| 16:9 | 기준 | 100% 표시, 검은 바 없음 |
| 21:9 (울트라와이드) | Pillarbox | 좌우 검은 바 |
| 16:10 | Letterbox | 상하 검은 바 |
| 4:3 | Letterbox | 상하 검은 바 |

---

## 지원 해상도

| 해상도 | 비율 | 대응 |
|--------|------|------|
| 1920×1080 | 16:9 | 기준 (100%) |
| 2560×1440 | 16:9 | 스케일 업 |
| 3840×2160 | 16:9 | 스케일 업 (4K) |
| 2560×1080 | 21:9 | 좌우 Pillarbox |
| 3440×1440 | 21:9 | 좌우 Pillarbox |
| 1920×1200 | 16:10 | 상하 Letterbox |
| 1280×1024 | 5:4 | 상하 Letterbox |

---

## Canvas Scaler 설정

```
Canvas Scaler
├── UI Scale Mode: Scale With Screen Size
├── Reference Resolution: 1920 x 1080
├── Screen Match Mode: Match Width Or Height
└── Match: 0.5
```

---

## Aspect Ratio 강제 구현

```csharp
using UnityEngine;

/// <summary>
/// 16:9 비율 강제 (Camera Viewport 방식)
/// </summary>
public class AspectRatioEnforcer : MonoBehaviour
{
    private const float TARGET_ASPECT = 16f / 9f;

    private void Start()
    {
        enforceAspectRatio();
    }

    private void enforceAspectRatio()
    {
        float windowAspect = (float)Screen.width / Screen.height;
        float scaleHeight = windowAspect / TARGET_ASPECT;

        Camera camera = GetComponent<Camera>();

        if (scaleHeight < 1.0f)
        {
            // 세로가 더 김 → 상하 레터박스
            Rect rect = camera.rect;
            rect.width = 1.0f;
            rect.height = scaleHeight;
            rect.x = 0;
            rect.y = (1.0f - scaleHeight) / 2.0f;
            camera.rect = rect;
        }
        else
        {
            // 가로가 더 김 → 좌우 필러박스
            float scaleWidth = 1.0f / scaleHeight;
            Rect rect = camera.rect;
            rect.width = scaleWidth;
            rect.height = 1.0f;
            rect.x = (1.0f - scaleWidth) / 2.0f;
            rect.y = 0;
            camera.rect = rect;
        }
    }
}
```

---

## SafeArea 유틸리티 (개념)

```csharp
/// <summary>
/// 16:9 SafeArea 계산 유틸리티
/// </summary>
public static class SafeArea16x9
{
    public const float REFERENCE_WIDTH = 1920f;
    public const float REFERENCE_HEIGHT = 1080f;
    public const float TARGET_ASPECT = 16f / 9f;

    /// <summary>
    /// 현재 화면에서 16:9 SafeArea의 Rect 반환
    /// </summary>
    public static Rect GetSafeAreaRect()
    {
        float screenWidth = Screen.width;
        float screenHeight = Screen.height;
        float screenAspect = screenWidth / screenHeight;

        float safeWidth, safeHeight;
        float offsetX = 0f, offsetY = 0f;

        if (screenAspect > TARGET_ASPECT)
        {
            // 가로가 더 김 (Pillarbox)
            safeHeight = screenHeight;
            safeWidth = screenHeight * TARGET_ASPECT;
            offsetX = (screenWidth - safeWidth) / 2f;
        }
        else
        {
            // 세로가 더 김 (Letterbox)
            safeWidth = screenWidth;
            safeHeight = screenWidth / TARGET_ASPECT;
            offsetY = (screenHeight - safeHeight) / 2f;
        }

        return new Rect(offsetX, offsetY, safeWidth, safeHeight);
    }
}
```

---

## 스프라이트 해상도 가이드

| 에셋 타입 | 기준 크기 | 4K 대응 | 비고 |
|----------|----------|---------|------|
| 카드 아트 | 256×384 | 512×768 | 2:3 비율 |
| 캐릭터 | 512×512 | 1024×1024 | 정사각형 |
| UI 아이콘 | 64×64 | 128×128 | POT 권장 |
| 배경 | 1920×1080 | 3840×2160 | 16:9 |

---

## 스크린샷 캡처 가이드

```csharp
/// <summary>
/// 16:9 SafeArea만 캡처
/// </summary>
public static Texture2D CaptureSafeArea()
{
    Rect safeArea = SafeArea16x9.GetSafeAreaRect();

    Texture2D screenshot = new Texture2D(
        (int)safeArea.width,
        (int)safeArea.height,
        TextureFormat.RGB24,
        false
    );

    screenshot.ReadPixels(safeArea, 0, 0);
    screenshot.Apply();

    return screenshot;
}
```

---

## 관련 문서

| 문서 | 설명 |
|------|------|
| [00. coding-convention.md](./00.%20coding-convention.md) | C# 코딩 컨벤션 |
| [02. scene-structure.md](./02.%20scene-structure.md) | 씬 구조 |
| [unity-project-architecture.md](./unity-project-architecture.md) | 전체 프로젝트 아키텍처 |
