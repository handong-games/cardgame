# 전직 시스템 (Class Advancement)

## 개요

플레이어가 공통 카드를 수집하여 전직 조건을 충족하면 상위 클래스로 전직할 수 있는 시스템.
하나의 카드가 여러 전직에 기여할 수 있으며, 조건 동시 충족 시 플레이어가 선택한다.

> 이 설계의 배경과 의사결정 과정은 [의사결정 기록](./decisions/class-advancement-decision.md) 참조

---

## 핵심 규칙

| 항목 | 내용 |
|------|------|
| **전직 조건** | 해당 전직의 "인정 카드" 3장 이상 보유 |
| **카드 공유** | 하나의 카드가 여러 전직에 기여 가능 |
| **선택권** | 여러 전직 조건 동시 충족 시 플레이어 선택 |
| **체크 시점** | 보상 카드 획득 후 |

---

## 전사 계열 전직

### 전직 목록

| 전직 | 아이콘 | 색상 | 컨셉 |
|------|:------:|------|------|
| 팔라딘 | ⚔️ | 금색 (#FFD700) | 수호자 - 공방 밸런스, 오라 |
| 버서커 | 🔥 | 빨강 (#FF4444) | 파괴자 - 리스크 공격, HP 소모 |
| 검사 | ⚔️ | 파랑 (#4488FF) | 기술자 - 통제된 폭력, 숙련된 기술 |

### 공통 카드 (7장)

| 카드 | 타입 | 비용 | 효과 | 인정 전직 | 분류 |
|------|------|:----:|------|----------|------|
| 전장의 의지 | 스킬 | 1 | 5 방어 + 5 데미지 | 팔라딘, 버서커, 검사 | 공통 |
| 강철 의지 | 스킬 | 1 | 8 방어 | 팔라딘, 버서커 | 공유 |
| 일섬 | 공격 | 2 | 12 데미지 | 버서커, 검사 | 공유 |
| 응수 | 스킬 | 1 | 4 방어 + 4 데미지 | 팔라딘, 검사 | 공유 |
| 신성한 집중 | 스킬 | 1 | 드로우 +1, 다음 공격 +2 | 팔라딘 | 전용 |
| 피의 대가 | 공격 | 1 | 8 데미지, HP -3 | 버서커 | 전용 |
| 연환참 | 공격 | 1 | 3 데미지 x3 | 검사 | 전용 |

### 전직별 인정 카드

| 전직 | 인정 카드 | 필요 장수 |
|------|----------|:---------:|
| **팔라딘** | 전장의 의지, 강철 의지, 응수, 신성한 집중 | 3장 |
| **버서커** | 전장의 의지, 강철 의지, 일섬, 피의 대가 | 3장 |
| **검사** | 전장의 의지, 일섬, 응수, 연환참 | 3장 |

### 전직 조건 충족 예시

| 보유 카드 | 팔라딘 | 버서커 | 검사 | 결과 |
|----------|:------:|:------:|:----:|------|
| 전장의 의지 x3 | 3/3 ✓ | 3/3 ✓ | 3/3 ✓ | **3개 중 선택** |
| 전장의 의지, 강철 의지, 신성한 집중 | 3/3 ✓ | 2/3 | 1/3 | **팔라딘 확정** |
| 전장의 의지, 일섬, 연환참 | 1/3 | 2/3 | 3/3 ✓ | **검사 확정** |
| 전장의 의지, 응수 x2 | 3/3 ✓ | 1/3 | 3/3 ✓ | **팔라딘 or 검사** |

---

## 전직 흐름

```
전투 승리
    ↓
보상 카드 3장 제시 (공통 카드풀에서)
    ↓
1장 선택 → 덱에 추가
    ↓
전직 조건 체크 (인정 카드 3장 이상?)
    ↓
[조건 충족]
    ├─ 1개 전직만 충족 → 해당 전직으로 전직
    └─ 여러 전직 충족 → 선택 UI 표시
    ↓
전직 보상 (오라 + 고유 카드 1장 선택)
```

---

## 전직 선택 UI

조건을 동시에 충족한 전직이 여러 개일 때:

```
┌─────────────────────────────────────────────────┐
│            전직 선택!                            │
│      여러 전직 조건을 충족했습니다                 │
│                                                 │
│  ┌──────────────┐  ┌──────────────┐            │
│  │   ⚔️         │  │   🔥         │            │
│  │   팔라딘      │  │   버서커      │            │
│  │              │  │              │            │
│  │ 수호자 -     │  │ 파괴자 -     │            │
│  │ 공방 밸런스   │  │ 리스크 공격  │            │
│  │              │  │              │            │
│  │ 턴 시작 시   │  │ HP 50% 이하  │            │
│  │ +2 방어,    │  │ 데미지 +50%  │            │
│  │ 공격 +1     │  │              │            │
│  └──────────────┘  └──────────────┘            │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 전직 보상

전직 시 획득하는 보상:

| 전직 | 전직 보상 카드 (1장 선택) |
|------|---------------------------|
| **팔라딘** | 헌신의 오라, 신성한 일격, 정화의 방패 |
| **버서커** | (TODO) |
| **검사** | (TODO) |

### 팔라딘 오라 시스템

| 항목 | 내용 |
|------|------|
| **지속 시간** | 3턴 |
| **중첩** | 여러 오라 동시 활성화 가능 |
| **갱신** | 같은 오라 재사용 시 지속 시간 갱신 |

| 오라명 | 효과 |
|--------|------|
| **헌신의 오라** | 턴 시작 +2 방어, 공격 +1 데미지 (전직 보상) |
| **정의의 오라** | 공격 카드 +2 데미지 |
| **수호의 오라** | 턴 시작 +4 방어 |

---

## 전직 후 보상 카드 풀

전직 후에는 해당 클래스 전용 카드만 보상으로 등장합니다.

### 클래스별 보상 카드 풀

| 클래스 | 보상 카드 풀 |
|--------|-------------|
| **전사** | 공통 카드 풀 (전장의 의지, 강철 의지 등) |
| **팔라딘** | 정의의 오라, 수호의 오라, 신성한 일격, 정화의 방패 |
| **버서커** | (TODO) |
| **검사** | (TODO) |

> 헌신의 오라는 전직 보상으로만 획득 가능 (일반 보상에서 등장하지 않음)

---

## 시작 덱

| 카드 | 수량 | 전직 기여 |
|------|:----:|:--------:|
| 타격 (Strike) | 4장 | 없음 |
| 방어 (Defend) | 2장 | 없음 |
| 강타 (Bash) | 1장 | 없음 |

> 시작 덱 카드는 전직에 기여하지 않음

---

## 장점

| 포인트 | 설명 |
|--------|------|
| **리스타트 불필요** | 어떤 카드든 전직에 기여 → "안 뜬다" 없음 |
| **선택권** | 조건 동시 충족 시 플레이어가 결정 |
| **유연한 빌드** | 초반엔 열려있다가 점점 방향 확정 |
| **의미있는 선택** | 카드 선택이 곧 전직 방향 |

---

## 구현 체크리스트

- [x] 공통 카드 데이터 정의 (`data/cards/common.ts`)
- [x] 카드-전직 인정 매핑 (`advancesTo` 필드)
- [x] 전직 조건 체크 로직 (`utils/advancementSystem.ts`)
- [x] 다중 전직 선택 UI (`RewardScreen.tsx`)
- [x] 전직 보상 지급 (`gameStore.ts`)
- [x] 전직 힌트 표시 (`AdvancementHint.tsx`)

---

## 관련 문서

| 문서 | 설명 |
|------|------|
| [전직 힌트 시스템](./advancement-hint.md) | 보상 화면에서의 전직 힌트 UI |
| [의사결정 기록](./decisions/class-advancement-decision.md) | 설계 과정의 고민과 선택 이유 |

> 이 문서 업데이트 시 위 관련 문서도 함께 검토하세요.

---

## 변경 이력

| 날짜 | 변경 내용 |
|------|----------|
| 2026-01-10 | 최초 작성 - 카드 획득 기반 전직 시스템 |
| 2026-01-10 | 전직 힌트 시스템 추가 |
| 2026-01-10 | **시스템 재설계** - 공통 카드 기반 + 카드 공유 구조로 변경 |
| 2026-01-10 | **구현 완료** - 실제 카드명 반영, 체크리스트 업데이트 |
| 2026-01-11 | 오라 시스템 변경 (3턴 지속, 중첩 가능), 오라 카드 2종 추가 |
| 2026-01-11 | 전직 후 보상 카드 풀 분리 시스템 추가 |
